<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Operativa - Rischio Maremoto Costa Jonica</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        :root {
            --primary-color: #0d47a1; /* Blu Scuro Intenso */
            --secondary-color: #f5f5f5; /* Grigio Sfondo */
            --dark-color: #212121; /* Nero Testo */
            --light-color: #ffffff;
            --danger-color: #c62828;
            --warning-color: #ef6c00;
            --info-color: #0277bd;
            --border-radius: 8px;
            --shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        * { box-sizing: border-box; }
        body {
            font-family: 'Roboto', sans-serif;
            line-height: 1.6;
            margin: 0;
            background-color: var(--secondary-color);
            color: var(--dark-color);
        }
        .container-fluid {
            max-width: 95%;
            margin: auto;
        }
        .main-header {
            background: var(--light-color);
            padding: 0.5rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #e0e0e0;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        .main-header .logos img {
            height: 50px;
            margin: 0 10px;
        }
        .main-header .title h1 {
            margin: 0;
            color: var(--primary-color);
            font-size: 1.8rem;
        }
        .operator-selector {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .operator-selector label {
            font-weight: 700;
            color: var(--primary-color);
        }
        .operator-selector select {
            padding: 8px 12px;
            border-radius: var(--border-radius);
            border: 2px solid var(--primary-color);
            font-size: 1rem;
            font-weight: 500;
        }
        .dashboard-container {
            display: flex;
            gap: 20px;
            padding: 20px 0;
        }
        .main-content {
            flex: 3; /* 70% width */
        }
        .sidebar {
            flex: 1; /* 30% width */
            position: sticky;
            top: 85px; /* height of header + padding */
            align-self: flex-start;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .tabs {
            display: flex;
            background: var(--light-color);
            flex-wrap: wrap;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            overflow: hidden;
        }
        .tab-link {
            padding: 15px;
            cursor: pointer;
            border: none;
            background: transparent;
            font-size: 1rem;
            font-weight: 700;
            color: var(--dark-color);
            transition: all 0.3s ease;
            flex-grow: 1;
            text-align: center;
            border-bottom: 4px solid transparent;
        }
        .tab-link.active, .tab-link:hover {
            color: var(--primary-color);
            background-color: #e3f2fd;
            border-bottom-color: var(--primary-color);
        }
        .tab-content {
            display: none;
            margin-top: 20px;
        }
        .tab-content.active {
            display: block;
        }
        .alert-section {
            border-radius: var(--border-radius);
            padding: 20px;
            margin-top: 20px;
            background: var(--light-color);
            border: 1px solid #ddd;
            transition: all 0.3s ease;
            box-shadow: var(--shadow);
        }
        .alert-orange { border-left: 5px solid var(--warning-color); }
        .alert-red { border-left: 5px solid var(--danger-color); }

        .section-highlight {
            box-shadow: 0 0 0 3px var(--info-color), var(--shadow);
            border-color: var(--info-color);
        }
        h2, h3 { color: var(--primary-color); }
        h2 { border-bottom: 2px solid #e0e0e0; padding-bottom: 10px; margin-top: 0; }
        h4.alert-title-orange { color: var(--warning-color); font-size: 1.5rem; }
        h4.alert-title-red { color: var(--danger-color); font-size: 1.5rem; }
        .card {
            background: var(--light-color);
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }
        .card h3 { margin-top: 0; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        th, td { padding: 12px 15px; border: 1px solid #e0e0e0; text-align: left; }
        th { background-color: #eceff1; font-weight: 700; }
        td i { margin-right: 8px; color: var(--primary-color); width: 20px; text-align: center; }
        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        .note, .primary-task-info {
            background-color: #e3f2fd;
            border-left: 6px solid var(--info-color);
            padding: 15px;
            margin: 20px 0;
            border-radius: var(--border-radius);
        }
        .primary-task-info { display: none; }
        .map-container {
            width: 100%;
            height: 300px;
            border-radius: var(--border-radius);
            overflow: hidden;
            border: 2px solid var(--primary-color);
        }
        .map-container iframe { width: 100%; height: 100%; border: 0; }
        .key-points ul { list-style-type: none; padding: 0; }
        .key-points li { background: #e8eaf6; margin-bottom: 8px; padding: 10px; border-radius: 4px; }
        .disclaimer {
            font-size: 0.9em;
            color: var(--danger-color);
            font-weight: bold;
            text-align: center;
            padding-top: 10px;
        }
        footer { text-align: center; padding: 20px; margin-top: 20px; background-color: var(--dark-color); color: var(--light-color); }
    </style>
</head>
<body>

    <header class="main-header">
        <div class="logos">
            <img src="LOGO.png" alt="Logo Istituzionale">
            <img src="icopc.gif" alt="Logo Protezione Civile">
        </div>
        <div class="title">
            <h1>Dashboard Operativa Maremoto</h1>
        </div>
        <div class="operator-selector">
            <label for="operator-role"><i class="fas fa-user-shield"></i> Ruolo Operativo:</label>
            <select id="operator-role" onchange="changeOperatorView(this.value)">
                <option value="tutti">Tutti / Prefettura</option>
                <option value="forze_ordine">Forze dell'Ordine</option>
                <option value="sindaco">Sindaco / Ufficio Tecnico</option>
                <option value="volontariato">Volontariato</option>
            </select>
        </div>
    </header>

    <div class="container-fluid">
        <div class="dashboard-container">
            <main class="main-content">
                <nav class="tabs">
                    <button class="tab-link active" data-tab-target="Generale" data-coords="40.25,16.7" data-zoom="10" data-comune="Costa Jonica" data-coc=""><i class="fas fa-info-circle"></i> Generali</button>
                    <button class="tab-link" data-tab-target="NS-Rotondella" data-coords="40.1258,16.5685" data-zoom="14" data-comune="Nova Siri - Rotondella" data-coc="P.zza Papa Giovanni XXIII">Nova Siri - Rotondella</button>
                    <button class="tab-link" data-tab-target="Policoro" data-coords="40.2032,16.6692" data-zoom="14" data-comune="Policoro" data-coc="Piazza A. Moro">Policoro</button>
                    <button class="tab-link" data-tab-target="Scanzano" data-coords="40.2512,16.6936" data-zoom="14" data-comune="Scanzano Jonico" data-coc="P.zza A. Gramsci">Scanzano J.</button>
                    <button class="tab-link" data-tab-target="Pisticci" data-coords="40.3185,16.7538" data-zoom="13" data-comune="Pisticci" data-coc="Non specificato (Area Marconia)">Pisticci</button>
                    <button class="tab-link" data-tab-target="Bernalda" data-coords="40.3736,16.8134" data-zoom="14" data-comune="Bernalda" data-coc="P.zza P.Giovanni XXIII">Bernalda</button>
                </nav>
                
                <div class="primary-task-info" id="task-info-box">
                     <p><i class="fas fa-bullseye"></i><strong>Compiti Primari:</strong> <span id="task-info-text"></span></p>
                </div>

                <div id="Generale" class="tab-content active">
                    <div class="card">
                        <h2><i class="fas fa-file-alt"></i> Procedure Generali e Livelli di Allerta</h2>
                        <p>Questo portale riassume le procedure operative e i modelli di intervento da attuare in caso di allarme maremoto per i comuni della costa Jonica: Nova Siri, Rotondella, Policoro, Scanzano Jonico, Pisticci e Bernalda.</p>
                        <div class="grid-container">
                            <div class="alert-section alert-orange">
                                <h4 class="alert-title-orange"><i class="fas fa-triangle-exclamation"></i> LIVELLO 1: Allerta Arancione</h4>
                                <ul>
                                    <li><strong>Condizione:</strong> Altezza d'onda (Run-up) <strong>&lt; [cite_start]1 metro</strong>. [cite: 819]</li>
                                    [cite_start]<li><strong>Inondazione:</strong> Ingressione media a terra di <strong>400 metri</strong>. [cite: 820]</li>
                                </ul>
                            </div>
                            <div class="alert-section alert-red">
                                <h4 class="alert-title-red"><i class="fas fa-skull-crossbones"></i> LIVELLO 2: Allerta Rossa</h4>
                                <ul>
                                    [cite_start]<li><strong>Condizione:</strong> Altezza d'onda (Run-up) compresa <strong>tra 1 e 10 metri</strong>. [cite: 118]</li>
                                    [cite_start]<li><strong>Inondazione:</strong> Ingressione media a terra di <strong>2.00 km</strong>. [cite: 119]</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="NS-Rotondella" class="tab-content">
                    <div class="card">
                        <h2><i class="fa-solid fa-people-group"></i> Modello Intercomunale: Nova Siri e Rotondella</h2>
                        <p>Procedure unificate per i comuni di Nova Siri e Rotondella. Mappa di riferimento: Pg. [cite_start]13 del Piano. [cite: 964]</p>
                        [cite_start]<div class="note"><strong>Attenzione:</strong> La via di allontanamento n.2 (Via Amarcord) prevede l'attraversamento di un passaggio a livello. [cite: 1059]</div>
                        <div class="alert-section alert-orange">
                            <h4 class="alert-title-orange">Allerta Arancione</h4>
                            <div class="grid-container">
                                <div class="procedural-section" id="nsr-orange-aree">
                                    <h3><i class="fas fa-shield-alt"></i> Aree Protezione Civile</h3>
                                    <table><tbody>
                                        [cite_start]<tr><td><i class="fas fa-route"></i> Vie di Allontanamento</td><td>2 percorsi [cite: 935]</td></tr>
                                        [cite_start]<tr><td><i class="fas fa-user-friends"></i> Aree di Attesa</td><td>2 (Via Heraclea, Via Magna Grecia) [cite: 1056]</td></tr>
                                        [cite_start]<tr><td><i class="fas fa-building"></i> C.O.C.</td><td>Comando P.L., P.zza Papa Giovanni XXIII [cite: 1056]</td></tr>
                                    </tbody></table>
                                </div>
                                <div class="procedural-section" id="nsr-orange-cancelli">
                                    [cite_start]<h3><i class="fas fa-traffic-light"></i> Cancelli da Attivare (3) [cite: 945]</h3>
                                    [cite_start]<table><thead><tr><th>Ubicazione [cite: 1116]</th></tr></thead><tbody>
                                        [cite_start]<tr><td>VIA IDROVORA (S.P. 107 LACCATA) [cite: 1120]</td></tr>
                                        [cite_start]<tr><td>VIA TRIESTE INCROCIO VIALE DELLA LIBERTA' [cite: 1123]</td></tr>
                                        [cite_start]<tr><td>VIA SIRIS (S.P. 104) INCROCIO VIA A. DE GASPERI [cite: 1126]</td></tr>
                                    </tbody></table>
                                </div>
                            </div>
                        </div>
                        <div class="alert-section alert-red">
                            <h4 class="alert-title-red">Allerta Rossa</h4>
                            <div class="grid-container">
                                 <div class="procedural-section" id="nsr-red-aree">
                                    <h3><i class="fas fa-shield-alt"></i> Aree Protezione Civile</h3>
                                    <table><tbody>
                                        [cite_start]<tr><td><i class="fas fa-route"></i> Vie di Allontanamento</td><td>4 percorsi [cite: 951]</td></tr>
                                        [cite_start]<tr><td><i class="fas fa-user-friends"></i> Aree di Attesa</td><td>2 (stesse dell'allerta arancione) [cite: 1093]</td></tr>
                                        [cite_start]<tr><td><i class="fas fa-building"></i> C.O.C.</td><td>Scuola pubblica (Liceo), Via V. Bachelet [cite: 1093]</td></tr>
                                    </tbody></table>
                                </div>
                                <div class="procedural-section" id="nsr-red-cancelli">
                                    [cite_start]<h3><i class="fas fa-traffic-light"></i> Cancelli da Attivare (7) [cite: 961, 1152]</h3>
                                    <p>Attivare i 3 dell'allerta arancione + 4 aggiuntivi su Via Gramsci, Via Magna Grecia, S.P. 104 e Via Tratturo Regio.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="Policoro" class="tab-content">
                     <div class="card">
                        <h2><i class="fa-solid fa-landmark"></i> Modello Comunale: Policoro</h2>
                        <p>Mappa di riferimento: Pg. [cite_start]18 del Piano. [cite: 1156]</p>
                        [cite_start]<div class="note"><strong>Attenzione:</strong> Le vie di allontanamento 1, 2 e 3 prevedono il transito di passaggi a livello, sottopassi S.S. 106 e il passaggio davanti al P.S. dell'Ospedale. [cite: 1243]</div>
                        <div class="alert-section alert-orange">
                            <h4 class="alert-title-orange">Allerta Arancione</h4>
                            <div class="grid-container">
                                <div class="procedural-section" id="pol-orange-aree">
                                    <h3><i class="fas fa-shield-alt"></i> Aree Protezione Civile</h3>
                                    <table><tbody>
                                        [cite_start]<tr><td><i class="fas fa-route"></i> Vie di Allontanamento</td><td>5 percorsi [cite: 935]</td></tr>
                                        [cite_start]<tr><td><i class="fas fa-user-friends"></i> Aree di Attesa</td><td>2 ("Palaercole", Campo Sportivo) [cite: 1233]</td></tr>
                                        [cite_start]<tr><td><i class="fas fa-building"></i> C.O.C./C.O.M.</td><td>Edificio Comunale / "Palaercole" [cite: 1233]</td></tr>
                                    </tbody></table>
                                </div>
                                <div class="procedural-section" id="pol-orange-cancelli">
                                    [cite_start]<h3><i class="fas fa-traffic-light"></i> Cancelli da Attivare (5) [cite: 945, 1261]</h3>
                                    <p>I cancelli sono posizionati su Via San Giusto, Via Catone, Via Lido (SP91), Via Oberdan e Via Mascagni (SP67).</p>
                                </div>
                            </div>
                        </div>
                        <div class="alert-section alert-red">
                            <h4 class="alert-title-red">Allerta Rossa</h4>
                            <div class="grid-container">
                                <div class="procedural-section" id="pol-red-aree">
                                    <h3><i class="fas fa-shield-alt"></i> Aree Protezione Civile</h3>
                                    <table><tbody>
                                        [cite_start]<tr><td><i class="fas fa-route"></i> Vie di Allontanamento</td><td>6 percorsi [cite: 951]</td></tr>
                                        [cite_start]<tr><td><i class="fas fa-user-friends"></i> Aree di Attesa</td><td>3 (si aggiunge Parc. ex Zuccherificio) [cite: 1253]</td></tr>
                                    </tbody></table>
                                </div>
                                <div class="procedural-section" id="pol-red-cancelli">
                                    [cite_start]<h3><i class="fas fa-traffic-light"></i> Cancelli da Attivare (13) [cite: 961, 1260]</h3>
                                    <p>Attivare i 5 dell'allerta arancione + 8 aggiuntivi per un controllo capillare, includendo la zona artigianale e gli incroci con la S.S. 106.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                 <div id="Scanzano" class="tab-content">
                     <div class="card">
                        <h2><i class="fa-solid fa-wheat-awn"></i> Modello Comunale: Scanzano Jonico</h2>
                        <p>Mappa di riferimento: Pg. [cite_start]23 del Piano. [cite: 1264]</p>
                         [cite_start]<div class="note"><strong>Attenzione:</strong> La via di allontanamento n.1 (Via Monviso) prevede un passaggio a livello; le vie 2 e 3 prevedono sottopassi ferroviari. [cite: 1346]</div>
                        <div class="alert-section alert-orange">
                            <h4 class="alert-title-orange">Allerta Arancione</h4>
                            <div class="grid-container">
                                <div class="procedural-section" id="sca-orange-aree">
                                    <h3><i class="fas fa-shield-alt"></i> Aree Protezione Civile</h3>
                                    <table><tbody>
                                        [cite_start]<tr><td><i class="fas fa-route"></i> Vie di Allontanamento</td><td>4 percorsi [cite: 935]</td></tr>
                                        [cite_start]<tr><td><i class="fas fa-user-friends"></i> Aree di Attesa</td><td>2 (Campo Sportivo, P.zza Libertà) [cite: 1347]</td></tr>
                                        [cite_start]<tr><td><i class="fas fa-building"></i> C.O.C.</td><td>Palazzo Baronale, P.zza A. Gramsci [cite: 1347]</td></tr>
                                    </tbody></table>
                                </div>
                                <div class="procedural-section" id="sca-orange-cancelli">
                                    [cite_start]<h3><i class="fas fa-traffic-light"></i> Cancelli da Attivare (4) [cite: 945, 1381]</h3>
                                    <p>Posizionati sugli accessi principali al lido: Via Monviso (SP60), Via Mare (SP59), Via Lido Torre (SP73) e Via Napoli.</p>
                                </div>
                            </div>
                        </div>
                         <div class="alert-section alert-red">
                            <h4 class="alert-title-red">Allerta Rossa</h4>
                            <div class="grid-container">
                                 <div class="procedural-section" id="sca-red-aree">
                                    <h3><i class="fas fa-shield-alt"></i> Aree Protezione Civile</h3>
                                     [cite_start]<p>Le aree (Attesa, Ammassamento, C.O.C.) sono le stesse dell'Allerta Arancione. [cite: 1361] [cite_start]Le vie di allontanamento diventano 6. [cite: 951]</p>
                                 </div>
                                <div class="procedural-section" id="sca-red-cancelli">
                                    [cite_start]<h3><i class="fas fa-traffic-light"></i> Cancelli da Attivare (10) [cite: 961, 1380]</h3>
                                    <p>Ai 4 dell'allerta arancione si aggiungono 6 cancelli per isolare anche le aree interne e la zona artigianale.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="Pisticci" class="tab-content">
                    <div class="card">
                        <h2><i class="fa-solid fa-industry"></i> Modello Comunale: Pisticci</h2>
                        <p>Mappa di riferimento: Pg. [cite_start]28 del Piano. [cite: 1384]</p>
                         <div class="alert-section alert-orange">
                            <h4 class="alert-title-orange">Allerta Arancione</h4>
                            <div class="grid-container">
                                <div class="procedural-section" id="pis-orange-aree">
                                    <h3><i class="fas fa-shield-alt"></i> Aree Protezione Civile</h3>
                                    <table><tbody>
                                        [cite_start]<tr><td><i class="fas fa-route"></i> Vie di Allontanamento</td><td>7 percorsi [cite: 935]</td></tr>
                                        [cite_start]<tr><td><i class="fas fa-user-friends"></i> Area di Attesa</td><td>1 (Loc. Ex Stazione di Marconia) [cite: 1436]</td></tr>
                                        <tr><td><i class="fas fa-building"></i> C.O.C.</td><td>Non specificato nell'allegato.</td></tr>
                                    </tbody></table>
                                </div>
                                <div class="procedural-section" id="pis-orange-cancelli">
                                    [cite_start]<h3><i class="fas fa-traffic-light"></i> Cancelli da Attivare (6) [cite: 945, 1496]</h3>
                                    <p>Coprono gli accessi costieri da Viale 48 fino a Località S. Basilio.</p>
                                </div>
                            </div>
                        </div>
                        <div class="alert-section alert-red">
                            <h4 class="alert-title-red">Allerta Rossa</h4>
                             <div class="grid-container">
                                 <div class="procedural-section" id="pis-red-aree">
                                    <h3><i class="fas fa-shield-alt"></i> Aree Protezione Civile</h3>
                                     [cite_start]<p>Le aree e le vie di allontanamento restano le stesse dell'Allerta Arancione. [cite: 1443, 574]</p>
                                 </div>
                                <div class="procedural-section" id="pis-red-cancelli">
                                    [cite_start]<h3><i class="fas fa-traffic-light"></i> Cancelli da Attivare (9) [cite: 961, 1495]</h3>
                                    <p>Ai 6 cancelli precedenti se ne aggiungono 3 per un isolamento più esteso dell'entroterra.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="Bernalda" class="tab-content">
                    <div class="card">
                        <h2><i class="fa-solid fa-gopuram"></i> Modello Comunale: Bernalda (Metaponto)</h2>
                        <p>Mappa di riferimento: Pg. [cite_start]33 del Piano. [cite: 1499]</p>
                         <div class="alert-section alert-orange">
                            <h4 class="alert-title-orange">Allerta Arancione</h4>
                            <div class="grid-container">
                                <div class="procedural-section" id="ber-orange-aree">
                                    <h3><i class="fas fa-shield-alt"></i> Aree Protezione Civile</h3>
                                    <table><tbody>
                                        [cite_start]<tr><td><i class="fas fa-route"></i> Vie di Allontanamento</td><td>9 percorsi [cite: 935]</td></tr>
                                        [cite_start]<tr><td><i class="fas fa-user-friends"></i> Area di Attesa</td><td>1 (Campo sportivo Metaponto) [cite: 693]</td></tr>
                                        [cite_start]<tr><td><i class="fas fa-building"></i> C.O.C.</td><td>Delegazione Comune, P.zza P.Giovanni XXIII [cite: 693]</td></tr>
                                    </tbody></table>
                                </div>
                                <div class="procedural-section" id="ber-orange-cancelli">
                                    [cite_start]<h3><i class="fas fa-traffic-light"></i> Cancelli da Attivare (2) [cite: 945, 726]</h3>
                                    <p>Due cancelli posizionati su Via del Lido (S.P. 40) per chiudere l'accesso principale a Metaponto Lido.</p>
                                </div>
                            </div>
                        </div>
                        <div class="alert-section alert-red">
                            <h4 class="alert-title-red">Allerta Rossa</h4>
                            <div class="grid-container">
                                 <div class="procedural-section" id="ber-red-aree">
                                    <h3><i class="fas fa-shield-alt"></i> Aree Protezione Civile</h3>
                                     [cite_start]<p>Le aree e le vie di allontanamento restano le stesse dell'Allerta Arancione. [cite: 711, 709]</p>
                                 </div>
                                <div class="procedural-section" id="ber-red-cancelli">
                                    [cite_start]<h3><i class="fas fa-traffic-light"></i> Cancelli da Attivare (3) [cite: 961, 725]</h3>
                                    <p>Ai 2 cancelli precedenti si aggiunge quello sulla Strada d'Argine Destra del Bradano per una chiusura completa.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </main>
            <aside class="sidebar">
                <div class="card">
                    <h3><i class="fas fa-phone-alt"></i> Contatti di Emergenza</h3>
                    <table>
                        <caption class="disclaimer"><i class="fas fa-exclamation-triangle"></i> ATTENZIONE: I numeri locali sono fittizi.</caption>
                        <thead>
                            <tr><th>Ente</th><th>Numero</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><i class="fas fa-exclamation-triangle"></i>N.U.E.</td><td><strong>112</strong></td></tr>
                            <tr><td><i class="fas fa-fire-extinguisher"></i>Vigili del Fuoco</td><td><strong>115</strong></td></tr>
                            <tr><td><i class="fas fa-heartbeat"></i>Emergenza Sanitaria</td><td><strong>118</strong></td></tr>
                            <tr><td><i class="fas fa-life-ring"></i>Guardia Costiera</td><td><strong>1530</strong></td></tr>
                            <tr><td><i class="fas fa-building"></i>Prefettura MT - S.O.</td><td><strong>0835 12345</strong></td></tr>
                            <tr><td><i class="fas fa-satellite-dish"></i>Prot. Civile REG - S.O.</td><td><strong>0971 654321</strong></td></tr>
                            <tr><td><i class="fas fa-user-shield"></i>Questura MT - S.O.</td><td><strong>0835 54321</strong></td></tr>
                        </tbody>
                    </table>
                </div>
                 <div class="card" id="coc-contacts-card">
                    <h3><i class="fas fa-headset"></i> Reperibilità C.O.C.</h3>
                    <div id="coc-contacts-content">
                        <p>Selezionare un comune per visualizzare i contatti.</p>
                    </div>
                 </div>
                 <div class="card">
                    <h3><i class="fas fa-map-marked-alt"></i> Mappa Operativa</h3>
                    <div class="map-container">
                         <iframe id="operative-map-iframe" src="https://maps.google.com/maps?q=40.25,16.7&t=&z=10&ie=UTF8&iwloc=&output=embed" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                    </div>
                    <div class="key-points">
                        <h4><i class="fas fa-map-pin"></i> Punti Chiave Comune Selezionato</h4>
                        <ul id="map-key-points">
                           <li>Visione d'insieme della costa.</li>
                        </ul>
                    </div>
                </div>
            </aside>
        </div>
    </div>

    <footer>
        <div class="container-fluid">
            <p>Fonte Dati: Prefettura di Matera - Aggiornamento del "Piano Provinciale di Protezione Civile per il Rischio Maremoto" (Rev. 2, 2023).</p>
            <p>Questo portale è una simulazione a scopo dimostrativo e non sostituisce i documenti ufficiali e le direttive operative.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const tabsContainer = document.querySelector('.tabs');
            const mapIframe = document.getElementById('operative-map-iframe');
            const keyPointsList = document.getElementById('map-key-points');
            const cocContactsContent = document.getElementById('coc-contacts-content');

            // Funzione per aggiornare la mappa e le info correlate
            function updateDynamicInfo(tab) {
                const coords = tab.dataset.coords;
                const zoom = tab.dataset.zoom;
                const coc = tab.dataset.coc;
                const comune = tab.dataset.comune;

                // 1. Aggiorna la mappa
                if (coords && zoom) {
                    mapIframe.src = `https://maps.google.com/maps?q=${coords}&t=&z=${zoom}&ie=UTF8&iwloc=&output=embed`;
                }

                // 2. Aggiorna i punti chiave
                if (coc) {
                    keyPointsList.innerHTML = `
                        <li><strong><i class="fas fa-building"></i> C.O.C. Location:</strong> ${coc}</li>
                        <li><strong><i class="fas fa-crosshairs"></i> Coordinate Focus:</strong> ${coords}</li>
                    `;
                } else {
                    keyPointsList.innerHTML = '<li>Visione d\'insieme della costa Jonica.</li>';
                }
                
                // 3. Aggiorna i contatti fittizi del C.O.C.
                if (comune && comune !== 'Costa Jonica') {
                    // Genera numeri fittizi basati su un hash semplice del nome del comune per renderli univoci
                    const hash = s => s.split('').reduce((a,b)=>{a=((a<<5)-a)+b.charCodeAt(0);return a&a},0);
                    let baseNum = Math.abs(hash(comune)).toString().substr(0, 6);
                    while(baseNum.length < 6) baseNum += '0';
                    
                    cocContactsContent.innerHTML = `
                        <p><strong>Comune:</strong> ${comune}</p>
                        <table>
                           <tr><td><i class="fas fa-user-tie"></i> Sindaco</td><td>331 ${baseNum.substr(0,3)} ${baseNum.substr(3,3)}</td></tr>
                           <tr><td><i class="fas fa-hard-hat"></i> Resp. Uff. Tecnico</td><td>338 ${baseNum.substr(3,3)} ${baseNum.substr(0,3)}</td></tr>
                        </table>
                    `;
                } else {
                    cocContactsContent.innerHTML = '<p>Selezionare un comune per visualizzare i contatti.</p>';
                }
            }

            // Event listener per la selezione delle schede
            tabsContainer.addEventListener('click', e => {
                const clickedTab = e.target.closest('.tab-link');
                if (!clickedTab) return;

                e.preventDefault();

                document.querySelectorAll('.tab-link').forEach(link => link.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                
                clickedTab.classList.add('active');
                const targetContent = document.getElementById(clickedTab.dataset.tabTarget);
                if(targetContent) targetContent.classList.add('active');
                
                updateDynamicInfo(clickedTab);
            });

            // Stato iniziale
            updateDynamicInfo(document.querySelector('.tab-link.active'));
        });

        // Funzione per la vista operatore
        function changeOperatorView(operator) {
            const taskInfoBox = document.getElementById('task-info-box');
            const taskInfoText = document.getElementById('task-info-text');
            
            document.querySelectorAll('.procedural-section').forEach(el => el.classList.remove('section-highlight'));
            taskInfoBox.style.display = 'none';

            switch(operator) {
                case 'forze_ordine':
                    taskInfoText.innerHTML = "Controllo accessi e viabilità. Evidenziati i <strong>Cancelli</strong> da presidiare.";
                    taskInfoBox.style.display = 'block';
                    document.querySelectorAll('[id*="-cancelli"]').forEach(el => el.classList.add('section-highlight'));
                    break;
                case 'sindaco':
                    taskInfoText.innerHTML = "Coordinamento comunale. Evidenziate le <strong>Aree di Protezione Civile</strong> e la localizzazione del C.O.C.";
                    taskInfoBox.style.display = 'block';
                    document.querySelectorAll('[id*="-aree"]').forEach(el => el.classList.add('section-highlight'));
                    break;
                case 'volontariato':
                    taskInfoText.innerHTML = "Assistenza alla popolazione. Evidenziate le <strong>Aree di Protezione Civile</strong> (Aree Attesa e Ammassamento).";
                    taskInfoBox.style.display = 'block';
                    document.querySelectorAll('[id*="-aree"]').forEach(el => el.classList.add('section-highlight'));
                    break;
                case 'tutti':
                default:
                    // Nessuna evidenziazione
                    break;
            }
        }
    </script>

</body>
</html>
